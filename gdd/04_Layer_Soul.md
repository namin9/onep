# GDD - Layer 4: 영혼 (The Soul)

## 1. 역할
- 환생(Prestige)을 통한 무한 성장 루프의 완성.
- '특성 트리'를 통해 유저가 자신의 성장 방향을 전략적으로 선택하게 함.
- 게임의 규칙 자체를 바꾸는 강력한 효과들로 후반부 게임 플레이의 깊이를 더함.

## 2. 핵심 메커니즘
- **환생 (Prestige):**
  - **조건:** 유저의 자유로운 선택. (단, 보통 성장의 벽에 부딪혔을 때 진행)
  - **초기화 대상:**
    - `User_Stats` 테이블의 모든 스탯 레벨.
    - 보유 루비.
    - 현재 진행 스테이지 (1스테이지로 복귀).
  - **유지 대상:**
    - `User_Skins` (모든 스킨 및 옵션).
    - `User_Cards` (모든 카드 및 도감 진행도).
    - `User_Talents` (해금한 모든 특성).
    - 보유한 '잉크', '서사의 파편' 등 특수 재화.

- **환생 재화: 서사의 파편**
  - **획득 공식:** `획득량 = FLOOR((도달한 최고 스테이지 / 10) ^ 1.5)`
    - `FLOOR` 함수를 통해 소수점은 버립니다.
    - **설계 의도:** 더 높은 스테이지에서 환생할수록 기하급수적으로 많은 재화를 얻도록 하여, '더 갈 것인가, 지금 환생할 것인가'의 전략적 딜레마를 제공합니다.

## 3. 특성 트리 (Talent Tree)
- '서사의 파편'을 소모하여 거대한 트리 형태의 특성을 해금합니다.
- **초기 특성 트리 예시 (일부):**
  - **Tier 1:**
    - `기초 다지기` (비용 1): 모든 Layer 1 스탯 레벨업 비용 5% 감소.
    - `탐욕` (비용 1): 루비 획득량 +10%.
  - **Tier 2:**
    - `장비의 중요성` (비용 5, 선행: 기초 다지기): 모든 스킨의 기본 보유 효과 +20%.
  - **Tier 3:**
    - `학자의 즐거움` (비용 10, 선행: 탐욕): 데이터 조각 드랍률 +10%.
  - **Tier 5 (고급 특성):**
    - `차원 왜곡` (비용 500): 공격 시 0.1% 확률로 현재 스테이지의 모든 일반 몬스터 즉사.
    - `문장의 재구성` (비용 750): 크리티컬 히트 시, 1% 확률로 '하이퍼 크리티컬'이 발동하여 10배의 데미지를 줌.

## 4. 관련 데이터베이스 테이블
- `Talents`, `User_Talents` (상세: `database/schema.sql` 참조)
